) %>%
collapse_rows(l, row_group_label_position = "identity") %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
collapse_rows("l", row_group_label_position = "identity") %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
collapse_rows(, row_group_label_position = "identity") %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
collapse_rows(row_group_label_position = "identity") %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
collapse_rows() %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle")
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(row.names = NULL, "Incentive Level" = c(rep("$0", 7), rep("$7000", 7), rep("$14000", 7)),
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle")
kable_styling(latex_options = c("scale_down"))
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(row.names = NULL, "Incentive Level" = c(rep("$0", 7), rep("$7000", 7), rep("$14000", 7)),
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle")
kable_styling(latex_options = c("scale_down"))
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(row.names = NULL, "Incentive Level" = c(rep("$0", 7), rep("$7000", 7), rep("$14000", 7)),
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle") %>%
kable_styling(latex_options = c("scale_down"))
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(row.names = NULL, "Incentive Level" = c(rep("$0", 7), rep("$7000", 7), rep("$14000", 7)),
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle") %>%
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(row.names = NULL, "Incentive Level" = c(rep("$0", 7), rep("$7000", 7), rep("$14000", 7)),
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
"latex",
align = "c",
digits = 2,
booktabs = TRUE
) %>%
column_spec(1, bold=T) %>%
collapse_rows(columns = 1:2, latex_hline = "major", valign = "middle")
collapse_rows_dt <- data.frame(),
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
collapse_rows_dt <- data.frame(
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion"),
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion")
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion")
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
kable_styling(latex_options = c("scale_down", "striped"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion (%)")
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c("" = 1,
"Average Purchase Price˜ ($)" = 3,
"" = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion (%)")
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price˜ ($)" = 3,
" " = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "Proportion (%)")
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price ($)" = 3,
" " = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
kable(collapse_rows_dt,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "As Selected"),
caption = "Mean Purchase Price of Vehicle by Powertrain, Incentive, and Vehicle Age"
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price ($)" = 3,
"Proportion (%)" = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
prop2 <- data.frame(
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(prop2,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "As Selected"),
caption = "Mean Purchase Price of Vehicle by Powertrain, Incentive, and Vehicle Age"
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price ($)" = 3,
"Proportion (%)" = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3", "4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
prop2 <- data.frame(
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(prop2,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "As Selected"),
caption = "Mean Purchase Price of Vehicle by Powertrain, Incentive, and Vehicle Age"
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price ($)" = 3,
"Proportion (%)" = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
#Load survey data from package into data frame.
df <- VDS_Data
# The focus of this work is on the design space exercise. Since the DS was presented near the end of the survey, there is concern that some respondents rushed through or did not adequately explore the tool. The effort here is to limit the number of those respondents from affecting the analysis.
min(df$TIME1)
mean(df$TIME1)
max(df$TIME1)
min(df$CHANGES1)
df$CHANGES1 <- as.numeric(df$CHANGES1)
mean(df$CHANGES1)
max(df$CHANGES1)
# The shortest amount of time and the least number of chages made to the exercise are both zero, which is unacceptable. The other concern is that some respondents spent excessive amounts of time to complete the design space and their responses may not be truly reflective. Respondents are filtered out if more than 20 minutes was taken to complete the exercise. The average time spent to complete the exercise was 3 minutes. Additionally, there is concern that respondents did not spend an adequate amount of time to fully understand the exercise. The removal of respondents is based off of the distribution of responses, those outside of 3 standard distributions of the data are considered to be outliers and are excluded from the analysis. A sensitivity analysis may be completed to compare the truncated dataset and the affect on the results, against all non-zero time and change values (i.e., any respondents who did not complete the design space are not included).
#Remove respondents that spent 0 seconds on the design space
df.Clean <- df %>% filter(TIME1 != 0)
#Calculate time mean and std dev for z-scores
df.Clean$time_sd <- sd(df.Clean$TIME1)*sqrt((length(df.Clean$TIME1)-1)/(length(df.Clean$TIME1)))
df.Clean$time_mean <- mean(df.Clean$TIME1)
df.Clean$Z_Score <- (df.Clean$TIME1 - df.Clean$time_mean) / df.Clean$time_sd
range(df.Clean$Z_Score) # Range of z-scores.
#Remove Time values less than -3 and greater than +3 steps from the mean
df.Clean <- df.Clean %>% filter(Z_Score >= -3 & Z_Score <= 3)
#Respondents were allowed, and encouraged, to make as many changes (moving the slider bars to different values) as they felt necessary to understand the different options available to them. Based off of the random geneation pattern, it is plausible that an individual could have been initialized with a vehicle combination they were content with (e.g., ICE-configuration with low purchase and operating cost) and as such respondents at minimum needed to only move the slider bar once to be able to continue. Respondents who made zero changes are removed.
df.Clean <- df.Clean %>% filter(CHANGES1 != 0)
VDS <- df.Clean
rm(df, df.Clean)
mod1 <- mlogit(depvar ~  pp + oc | INCENT1 + BODY_TYPE, Behaviour, reflevel = "ice")
View(Proportion2)
View(Proportion)
View(VDS)
summary(VDS$depvar)
plot(VDS$depvar)
count(VDS$depvar[depvar=="phevlg"])
count(VDS$depvar[VDS$depvar=="phevlg"])
rownames(VDS$depvar[VDS$depvar=="phevlg"])
View(Proportion)
View(Proportion)
```{r prop, echo=FALSE, fig.cap= "\\{tab:prop} Purchase Price, Operating Cost, and Proprotion of Vehicles Designed"}
Proportion <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3","4", "5", "6", "7"))) %>%
group_by(depvar) %>%
summarise(no_rows =length(depvar))
df <- data.frame(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE"),
"$Mean Purchase Price$" = c(mean(VDS$pp.ice), mean(VDS$pp.iceh), mean(VDS$pp.phevse), mean(VDS$pp.phevle), mean(VDS$pp.phevlg), mean(VDS$pp.bevs), mean(VDS$pp.bevl)),
"Median Purchase Price" = c(median(VDS$pp.ice), median(VDS$pp.iceh), median(VDS$pp.phevse), median(VDS$pp.phevle), median(VDS$pp.phevlg), median(VDS$pp.bevs), median(VDS$pp.bevl)),
"Mean Operating Cost" = c(mean(VDS$oc.ice), mean(VDS$oc.ice_hybrid), mean(VDS$oc.phevse), mean(VDS$oc.phevle), mean(VDS$oc.phevlg), mean(VDS$oc.bevs), mean(VDS$oc.bevl)),
"Median Operating Cost" = c(median(VDS$oc.ice), median(VDS$oc.ice_hybrid), median(VDS$oc.phevse), median(VDS$oc.phevle), median(VDS$oc.phevlg), median(VDS$oc.bevs), median(VDS$oc.bevl)),
Proportion = (Proportion$no_rows/16758)*100
)
df %>%
kable(
digits = 2,
col.names = c("", "Mean", "Median", "Mean", "Median", "As Selected"),
align = "c",
booktabs = TRUE,
caption = "Purchase Price, Operating Cost, and Proprotion of Vehicles Designed"
) %>%
pack_rows("Gasoline Only", 1, 2) %>%
pack_rows("Gasoline & Electricity", 3, 5) %>%
pack_rows("Electricity Only", 6, 7) %>%
add_header_above(c("Vehicle Powertrain" = 1,
"Purchase Price˜ ($)" = 2,
"Operating Cost* ($)" = 2,
"Proportion (%)" = 1),
escape = TRUE) %>%
footnote(c(paste("˜ Approximate cost to purchase a class-represntative vehicle, inclusive of tax"),
paste("* Approximate cost to operate (drive) a class-representative vehicle for 1,000km"))) %>%
kable_styling()
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
View(Proportion2)
#Questions
#What are the questions that we are looking to answer?
#  Using the techniques from the course, provide a summary overview of the data
#  Determine the
#  Estimate the marginal effects and elasticities
#    Do this with nesting
#  Estimate the probabilities
#  Estimate the willingness to pay
#  Estimate the impact of a new choice (e.g. fuel cell or longer range gasoline vehicles)
#  Compare proportional and non-proportional substitution patterns
#Does it make sense to break the data out and run seperate analyses?
#  E.g., by bodytype, incentive level, home charging access
library(tidyverse)
library(evd)
library(mlogit)
library(kableExtra)
library(knitr)
library(VDS)
library(MASS)
include_graphics("figures/VDS_Init.png")
include_graphics("figures/VDS_Selected.png")
#Load survey data from package into data frame.
df <- VDS_Data
# The focus of this work is on the design space exercise. Since the DS was presented near the end of the survey, there is concern that some respondents rushed through or did not adequately explore the tool. The effort here is to limit the number of those respondents from affecting the analysis.
min(df$TIME1)
mean(df$TIME1)
max(df$TIME1)
min(df$CHANGES1)
df$CHANGES1 <- as.numeric(df$CHANGES1)
mean(df$CHANGES1)
max(df$CHANGES1)
# The shortest amount of time and the least number of chages made to the exercise are both zero, which is unacceptable. The other concern is that some respondents spent excessive amounts of time to complete the design space and their responses may not be truly reflective. Respondents are filtered out if more than 20 minutes was taken to complete the exercise. The average time spent to complete the exercise was 3 minutes. Additionally, there is concern that respondents did not spend an adequate amount of time to fully understand the exercise. The removal of respondents is based off of the distribution of responses, those outside of 3 standard distributions of the data are considered to be outliers and are excluded from the analysis. A sensitivity analysis may be completed to compare the truncated dataset and the affect on the results, against all non-zero time and change values (i.e., any respondents who did not complete the design space are not included).
#Remove respondents that spent 0 seconds on the design space
df.Clean <- df %>% filter(TIME1 != 0)
#Calculate time mean and std dev for z-scores
df.Clean$time_sd <- sd(df.Clean$TIME1)*sqrt((length(df.Clean$TIME1)-1)/(length(df.Clean$TIME1)))
df.Clean$time_mean <- mean(df.Clean$TIME1)
df.Clean$Z_Score <- (df.Clean$TIME1 - df.Clean$time_mean) / df.Clean$time_sd
range(df.Clean$Z_Score) # Range of z-scores.
#Remove Time values less than -3 and greater than +3 steps from the mean
df.Clean <- df.Clean %>% filter(Z_Score >= -3 & Z_Score <= 3)
#Respondents were allowed, and encouraged, to make as many changes (moving the slider bars to different values) as they felt necessary to understand the different options available to them. Based off of the random geneation pattern, it is plausible that an individual could have been initialized with a vehicle combination they were content with (e.g., ICE-configuration with low purchase and operating cost) and as such respondents at minimum needed to only move the slider bar once to be able to continue. Respondents who made zero changes are removed.
df.Clean <- df.Clean %>% filter(CHANGES1 != 0)
VDS <- df.Clean
rm(df, df.Clean)
# Select and reorder the columns in the data frame to prepare them to be transformed for the mlogit model. Fields are ordered by the different choices provided to respondents for the purchase and operating cost. Two of the field names are changed to be in the appropriate format for the 'varying' function to identify them correctly.
# This function lives here as the reordered datatable feeds into the two following boxplots.
df2 <- VDS[,c(1:114, 117, 120, 123, 126, 129, 115, 116, 118, 119, 121, 122, 124, 125, 127, 128, 130:ncol(VDS))]
colnames(df2)[114] <- "oc.hev"
colnames(df2)[107] <- "pp.hev"
df2$Incentive <- df2$INCENT1
df2$Age <- df2$AGE1
model_base <- df2
Behaviour <- mlogit.data(df2, shape = "wide", choice = "depvar", varying = c(106:119)) # Change the shape of the dataframe from wide, to a long format so that the mlogit function can read the data and estimate the models.
bp.pp <- ggplot(df2, aes(depvar, CASH_PP1)) + geom_boxplot() + labs(x="Powertrain", y= "Purchase Price ($)", title = "Purchase Cost of Vehicles by Powertrain and Body Type")
bp.pp <- bp.pp + facet_wrap(~BODY_TYPE)
bp.pp
df2$depvar <- factor(df2$depvar, labels = c("BL", "BS", "I", "H", "PLE", "PLG", "PSE"))
bp.oc <- ggplot(df2, aes(x = depvar, y=CASH_PP1)) + geom_boxplot() + labs(x="Powertrain", y= "Purchase Cost ($)", caption = "Incentive in $s, Age in Years", title = "Purchase Cost of Vehicles by Powertrain, Incentive, and Vehicle Age")
bp.oc <- bp.oc + facet_grid(Age~Incentive, labeller = label_both)
bp.oc
Proportion <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3","4", "5", "6", "7"))) %>%
group_by(depvar) %>%
summarise(no_rows =length(depvar))
df <- data.frame(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE"),
"$Mean Purchase Price$" = c(mean(VDS$pp.ice), mean(VDS$pp.iceh), mean(VDS$pp.phevse), mean(VDS$pp.phevle), mean(VDS$pp.phevlg), mean(VDS$pp.bevs), mean(VDS$pp.bevl)),
"Median Purchase Price" = c(median(VDS$pp.ice), median(VDS$pp.iceh), median(VDS$pp.phevse), median(VDS$pp.phevle), median(VDS$pp.phevlg), median(VDS$pp.bevs), median(VDS$pp.bevl)),
"Mean Operating Cost" = c(mean(VDS$oc.ice), mean(VDS$oc.ice_hybrid), mean(VDS$oc.phevse), mean(VDS$oc.phevle), mean(VDS$oc.phevlg), mean(VDS$oc.bevs), mean(VDS$oc.bevl)),
"Median Operating Cost" = c(median(VDS$oc.ice), median(VDS$oc.ice_hybrid), median(VDS$oc.phevse), median(VDS$oc.phevle), median(VDS$oc.phevlg), median(VDS$oc.bevs), median(VDS$oc.bevl)),
Proportion = (Proportion$no_rows/16758)*100
)
df %>%
kable(
digits = 2,
col.names = c("", "Mean", "Median", "Mean", "Median", "As Selected"),
align = "c",
booktabs = TRUE,
caption = "Purchase Price, Operating Cost, and Proprotion of Vehicles Designed"
) %>%
pack_rows("Gasoline Only", 1, 2) %>%
pack_rows("Gasoline & Electricity", 3, 5) %>%
pack_rows("Electricity Only", 6, 7) %>%
add_header_above(c("Vehicle Powertrain" = 1,
"Purchase Price˜ ($)" = 2,
"Operating Cost* ($)" = 2,
"Proportion (%)" = 1),
escape = TRUE) %>%
footnote(c(paste("˜ Approximate cost to purchase a class-represntative vehicle, inclusive of tax"),
paste("* Approximate cost to operate (drive) a class-representative vehicle for 1,000km"))) %>%
kable_styling()
Proportion2 <- VDS %>% mutate(depvar = factor(depvar,
levels = c("ice", "hev", "phevse", "phevle", "phevlg", "bevs", "bevl" ), labels = c("1","2","3","4", "5", "6", "7"))) %>%
group_by(INCENT1,depvar) %>%
summarise(no_rows =length(depvar))
prop2 <- data.frame(
"Powertrain" = c(rep(c(Powertrain = c("ICE", "HEV", "PHEV SE", "PHEV LE", "PHEV LG", "BEV SE", "BEV LE")) )),
"New Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==0]),
mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==0]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.phevlg[14000& VDS$AGE1==0]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==0]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==0])),
"2 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==2]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.phevlg[14000& VDS$AGE1==2]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==2]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==2])),
"5 Year Old Vehicle" = c(mean(VDS$pp.ice[VDS$INCENT1==0 & VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==0& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==0& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.phevlg[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==7000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==7000& VDS$AGE1==5]),mean(VDS$pp.ice[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.iceh[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevse[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevle[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.phevlg[14000& VDS$AGE1==5]), mean(VDS$pp.bevs[VDS$INCENT1==14000& VDS$AGE1==5]), mean(VDS$pp.bevl[VDS$INCENT1==14000& VDS$AGE1==5])),
Proportion = (Proportion2$no_rows/16758)*100)
kable(prop2,
align = "c",
digits = 2,
booktabs = TRUE,
col.names = c("Powertrain", "New Vehicle", "2 Year Old Vehicle", "5 Year Old Vehicle", "As Selected"),
caption = "Mean Purchase Price of Vehicle by Powertrain, Incentive, and Vehicle Age"
) %>%
pack_rows("$0 Incentive", 1, 7) %>%
pack_rows("$7 000 Incentive", 8, 14) %>%
pack_rows("$14 000 Incentive", 15, 21) %>%
add_header_above(c(" " = 1,
"Average Purchase Price ($)" = 3,
"Proportion (%)" = 1),
escape = TRUE) %>%
kable_styling(latex_options = c("scale_down"))
mod1 <- mlogit(depvar ~  pp + oc, Behaviour, reflevel = "ice")
summary(mod1)
mod1 <- mlogit(depvar ~  pp, Behaviour, reflevel = "ice")
summary(mod1)
mixl_t.summary <- rownames_to_column(data.frame(summary(mod1)$CoefTable), "Variable") %>%
transmute(Variable, Estimate, pval = `Pr...z..`)
